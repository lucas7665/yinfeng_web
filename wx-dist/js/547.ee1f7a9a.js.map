{"version":3,"file":"js/547.ee1f7a9a.js","mappings":"mVAiCA,MAAMA,GAASC,EAAAA,EAAAA,MACTC,GAAUC,EAAAA,EAAAA,KAAI,GAGdC,EAAOC,EAAAA,EAAMC,OAAO,CACxBC,QAAS,oCACTC,QAAS,IACTC,QAAS,CACP,eAAgB,sBAKpBL,EAAKM,aAAaC,QAAQC,KAAIC,IAC5B,MAAMC,EAAQC,aAAaC,QAAQ,SAInC,OAHIF,IACFD,EAAOJ,QAAQQ,cAAgB,UAAUH,KAEpCD,CAAK,IAId,MAAMK,EAAkBA,KACtB,MAAMC,EAAKC,UAAUC,UAAUC,cAC/B,OAAyC,IAAlCH,EAAGI,QAAQ,iBAAwB,EAItCC,EAAeC,UACnB,IAEE,MAAMC,EAAMC,OAAOC,SAASC,KAAKC,MAAM,KAAK,GAGtCC,QAAY3B,EAAK4B,IAAI,gCAAiC,CAC1DC,OAAQ,CAAEP,SAGZ,GAAsB,IAAlBK,EAAIG,KAAKC,KAAY,CACvB,MAAMtB,EAASkB,EAAIG,KAAKA,KAExBE,GAAGvB,OAAO,CACRwB,OAAO,EACPC,MAAOzB,EAAOyB,MACdC,UAAW1B,EAAO0B,UAClBC,SAAU3B,EAAO2B,SACjBC,UAAW5B,EAAO4B,UAClBC,UAAW,CAAC,iBAIdN,GAAGO,OAAM,KACPC,QAAQC,IAAI,SAAS,IAIvBT,GAAGU,OAAOC,IACRH,QAAQE,MAAM,UAAWC,IACzBC,EAAAA,EAAAA,IAAU,iBAAiB,GAE/B,CACF,CAAE,MAAOF,GACPF,QAAQE,MAAM,aAAcA,IAC5BE,EAAAA,EAAAA,IAAU,gBACZ,GAIIC,EAAgBxB,UACpB,IAAIvB,EAAQgD,MAEZ,GAAKhC,IAAL,CAKAhB,EAAQgD,OAAQ,EAEhB,IAEE,MAAMnB,QAAY3B,EAAK+C,KAAK,kCAE5B,GAAsB,IAAlBpB,EAAIG,KAAKC,KAAY,CACvB,MAAMiB,EAAYrB,EAAIG,KAAKA,KAI3BE,GAAGiB,YAAY,CACbd,UAAWa,EAAUE,UACrBd,SAAUY,EAAUZ,SACpBe,QAASH,EAAUG,QACnBC,SAAUJ,EAAUI,SACpBC,QAASL,EAAUK,QACnBC,QAAS,YACPV,EAAAA,EAAAA,IAAU,QAEVhD,EAAO2D,KAAK,aACd,EACAC,KAAM,SAASb,GACbH,QAAQE,MAAM,QAASC,IACvBC,EAAAA,EAAAA,IAAU,WACZ,EACAa,OAAQ,YACNb,EAAAA,EAAAA,IAAU,QACZ,GAEJ,MACEA,EAAAA,EAAAA,IAAUjB,EAAIG,KAAK4B,SAAW,WAElC,CAAE,MAAOhB,GACPF,QAAQE,MAAM,QAASA,IACvBE,EAAAA,EAAAA,IAAU,aACZ,CAAE,QACA9C,EAAQgD,OAAQ,CAClB,CAxCA,MAFEF,EAAAA,EAAAA,IAAU,aA0CZ,E,OAIFe,EAAAA,EAAAA,KAAU,KACJ7C,KACFM,GACF,I,yjBCpJF,MAAMwC,GAA2B,OAAgB,EAAQ,CAAC,CAAC,YAAY,qBAEvE,O","sources":["webpack://health-app/./src/views/Payment.vue","webpack://health-app/./src/views/Payment.vue?5c4a"],"sourcesContent":["<template>\n  <div class=\"payment-container\">\n    <div class=\"payment-card\">\n      <h1>升级会员</h1>\n      \n      <div class=\"price-section\">\n        <h2>¥99.00</h2>\n        <p>每月</p>\n      </div>\n\n      <div class=\"benefits-section\">\n        <h3>会员权益</h3>\n        <ul>\n          <li>每月500条对话额度</li>\n          <li>优先客服支持</li>\n          <li>高级AI模型使用权限</li>\n          <li>自定义知识库</li>\n        </ul>\n      </div>\n\n      <button class=\"payment-button\" @click=\"handlePayment\" :disabled=\"loading\">\n        {{ loading ? '处理中...' : '立即开通' }}\n      </button>\n    </div>\n  </div>\n</template>\n\n<script setup>\nimport { ref, onMounted } from 'vue'\nimport { showToast } from 'vant'\nimport { useRouter } from 'vue-router'\nimport axios from 'axios'\n\nconst router = useRouter()\nconst loading = ref(false)\n\n// 创建 axios 实例\nconst http = axios.create({\n  baseURL: 'https://lgj-8082.colorstoneai.com',\n  timeout: 10000,\n  headers: {\n    'Content-Type': 'application/json'\n  }\n})\n\n// 请求拦截器：添加 token\nhttp.interceptors.request.use(config => {\n  const token = localStorage.getItem('token')\n  if (token) {\n    config.headers.Authorization = `Bearer ${token}`\n  }\n  return config\n})\n\n// 检查是否在微信浏览器中\nconst isWeixinBrowser = () => {\n  const ua = navigator.userAgent.toLowerCase()\n  return ua.indexOf('micromessenger') !== -1\n}\n\n// 初始化微信配置\nconst initWxConfig = async () => {\n  try {\n    // 获取当前页面URL（去除hash部分）\n    const url = window.location.href.split('#')[0]\n    \n    // 获取JSAPI配置\n    const res = await http.get('/api/auth/wechat/jsapi-config', {\n      params: { url }\n    })\n    \n    if (res.data.code === 0) {\n      const config = res.data.data\n      // eslint-disable-next-line no-undef\n      wx.config({\n        debug: false,\n        appId: config.appId,\n        timestamp: config.timestamp,\n        nonceStr: config.nonceStr,\n        signature: config.signature,\n        jsApiList: ['chooseWXPay']\n      })\n\n      // eslint-disable-next-line no-undef\n      wx.ready(() => {\n        console.log('微信配置成功')\n      })\n\n      // eslint-disable-next-line no-undef\n      wx.error((err) => {\n        console.error('微信配置失败:', err)\n        showToast('微信配置失败，请刷新页面重试')\n      })\n    }\n  } catch (error) {\n    console.error('初始化微信配置失败:', error)\n    showToast('初始化失败，请刷新页面重试')\n  }\n}\n\n// 处理支付\nconst handlePayment = async () => {\n  if (loading.value) return\n  \n  if (!isWeixinBrowser()) {\n    showToast('请在微信浏览器中打开')\n    return\n  }\n  \n  loading.value = true\n\n  try {\n    // 创建JSAPI支付订单\n    const res = await http.post('/api/auth/wechat/payment/jsapi')\n    \n    if (res.data.code === 0) {\n      const payParams = res.data.data\n      \n      // 调起微信支付\n      // eslint-disable-next-line no-undef\n      wx.chooseWXPay({\n        timestamp: payParams.timeStamp,\n        nonceStr: payParams.nonceStr,\n        package: payParams.package,\n        signType: payParams.signType,\n        paySign: payParams.paySign,\n        success: function() {\n          showToast('支付成功')\n          // 支付成功后跳转到助手页面\n          router.push('/assistant')\n        },\n        fail: function(err) {\n          console.error('支付失败:', err)\n          showToast('支付失败，请重试')\n        },\n        cancel: function() {\n          showToast('已取消支付')\n        }\n      })\n    } else {\n      showToast(res.data.message || '创建支付订单失败')\n    }\n  } catch (error) {\n    console.error('支付失败:', error)\n    showToast('支付失败，请稍后重试')\n  } finally {\n    loading.value = false\n  }\n}\n\n// 组件挂载时初始化微信配置\nonMounted(() => {\n  if (isWeixinBrowser()) {\n    initWxConfig()\n  }\n})\n</script>\n\n<style scoped>\n.payment-container {\n  display: flex;\n  justify-content: center;\n  align-items: center;\n  min-height: 100vh;\n  background-color: #f5f5f5;\n  padding: 20px;\n}\n\n.payment-card {\n  background: white;\n  border-radius: 12px;\n  padding: 40px;\n  box-shadow: 0 4px 6px rgba(0, 0, 0, 0.1);\n  max-width: 400px;\n  width: 100%;\n}\n\nh1 {\n  text-align: center;\n  color: #333;\n  margin-bottom: 30px;\n}\n\n.price-section {\n  text-align: center;\n  margin-bottom: 30px;\n}\n\n.price-section h2 {\n  font-size: 36px;\n  color: #2c3e50;\n  margin: 0;\n}\n\n.price-section p {\n  color: #666;\n  margin: 5px 0 0;\n}\n\n.benefits-section {\n  margin-bottom: 30px;\n}\n\n.benefits-section h3 {\n  color: #333;\n  margin-bottom: 15px;\n}\n\n.benefits-section ul {\n  list-style: none;\n  padding: 0;\n}\n\n.benefits-section li {\n  padding: 10px 0;\n  color: #666;\n  position: relative;\n  padding-left: 25px;\n}\n\n.benefits-section li:before {\n  content: \"✓\";\n  position: absolute;\n  left: 0;\n  color: #42b983;\n}\n\n.payment-button {\n  width: 100%;\n  padding: 15px;\n  background-color: #42b983;\n  color: white;\n  border: none;\n  border-radius: 6px;\n  font-size: 16px;\n  cursor: pointer;\n  transition: background-color 0.3s;\n}\n\n.payment-button:hover {\n  background-color: #3aa876;\n}\n\n.payment-button:disabled {\n  background-color: #a8d5c3;\n  cursor: not-allowed;\n}\n</style> ","import script from \"./Payment.vue?vue&type=script&setup=true&lang=js\"\nexport * from \"./Payment.vue?vue&type=script&setup=true&lang=js\"\n\nimport \"./Payment.vue?vue&type=style&index=0&id=e02cc5e4&scoped=true&lang=css\"\n\nimport exportComponent from \"../../node_modules/vue-loader/dist/exportHelper.js\"\nconst __exports__ = /*#__PURE__*/exportComponent(script, [['__scopeId',\"data-v-e02cc5e4\"]])\n\nexport default __exports__"],"names":["router","useRouter","loading","ref","http","axios","create","baseURL","timeout","headers","interceptors","request","use","config","token","localStorage","getItem","Authorization","isWeixinBrowser","ua","navigator","userAgent","toLowerCase","indexOf","initWxConfig","async","url","window","location","href","split","res","get","params","data","code","wx","debug","appId","timestamp","nonceStr","signature","jsApiList","ready","console","log","error","err","showToast","handlePayment","value","post","payParams","chooseWXPay","timeStamp","package","signType","paySign","success","push","fail","cancel","message","onMounted","__exports__"],"sourceRoot":""}