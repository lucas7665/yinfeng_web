"use strict";(self["webpackChunkhealth_app"]=self["webpackChunkhealth_app"]||[]).push([[629],{8629:function(a,e,t){t.r(e),t.d(e,{default:function(){return p}});t(4114);var o=t(6768),s=t(1387),n=t(715),c=t(4373);const r={class:"callback-page"};var l={__name:"WxCallback",setup(a){const e=(0,s.rd)(),t=(0,s.lq)();return(0,o.sV)((async()=>{const{code:a}=t.query;if(!a)return(0,n.P0)("登录失败，请重试"),void e.push("/login");try{const t=c.A.create({baseURL:"https://lgj-8082.colorstoneai.com",timeout:1e4,headers:{"Content-Type":"application/json"}}),o=await t.get(`/api/auth/wechat/callback?code=${a}`);if(console.log("微信回调响应:",o.data),200===o.data.code){const{token:a,user:t}=o.data.data;console.log("获取到的token和用户信息:",{token:a,user:t}),localStorage.setItem("token",a),localStorage.setItem("Authorization",`Bearer ${a}`),localStorage.setItem("userInfo",JSON.stringify(t)),(0,n.P0)("登录成功"),await e.push("/report")}else(0,n.P0)(o.data.message||"登录失败"),await e.push("/login")}catch(o){console.error("微信登录回调处理失败:",o),(0,n.P0)("登录失败，请重试"),await e.push("/login")}})),(a,e)=>{const t=(0,o.g2)("van-loading");return(0,o.uX)(),(0,o.CE)("div",r,[(0,o.bF)(t,{size:"24px",vertical:""},{default:(0,o.k6)((()=>e[0]||(e[0]=[(0,o.eW)("登录处理中...")]))),_:1})])}}},i=t(1241);const u=(0,i.A)(l,[["__scopeId","data-v-4d489b1c"]]);var p=u}}]);
//# sourceMappingURL=629.f63f8c3a.js.map